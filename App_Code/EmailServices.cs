using System;
using System.Collections.Generic;
using System.Configuration;
using System.Linq;
using System.Net.Mail;
using System.Web;

/// <summary>
/// Summary description for EmailServices
/// </summary>
public class EmailServices
{
    public string EmailPoint(string Type, string FullName, string From, string To, string Subject, string Content, string post)
    {
        try
        {
            string URL = ConfigurationManager.AppSettings["WebSiteURL"].ToString() + "Confirm.aspx?confirm=" + HttpContext.Current.Session["GatewayEMPUID"].ToString();
            MailMessage msg = new MailMessage();
            msg.From = new MailAddress(ConfigurationManager.AppSettings["Email_Sender"], "SparesMe " + Type);
            msg.To.Add(new MailAddress(To, "SparesMe " + Type));//TimeZoneInfo.ConvertTimeFromUtc(datet, tz).ToString("HHmmss")            
            msg.Subject = Subject + " : SparesMe";
            msg.IsBodyHtml = true;
            msg.Body = string.Format("<html><head>    <title></title></head><body>    <table width='auto' cellpadding='0' cellspacing='0' border='0' dir='ltr' lang='en' style='    border: 3px solid #f86971;'>        <tbody>            <tr>                <td valign='top' width='0'></td>                <td valign='top'>                    <table width='640' cellpadding='0' cellspacing='0' border='0' dir='ltr' lang='en'>                        <tbody>                            <tr style='background-color: #f86870;width:100%'>                                <td width='1'></td>                                <td width='24'>&nbsp;</td>                                <td width='310' valign='middle' style=';padding:12px 0'>                                    <h1 style='line-height:20pt;font-family:Segoe UI Light;font-size:18pt;color:#ffffff;font-weight:normal'>                                        <span style='color:#ffffff'>Verify your email address</span>                                    </h1>                                </td>                                <td width='24'>&nbsp;</td>                            </tr>                        </tbody>                    </table>                    <table width='640' cellpadding='0' cellspacing='0' border='0' dir='ltr' lang='en'>                        <tbody>                            <tr>                                <td width='1'></td>                                <td width='24'>&nbsp;</td>                                <td id='m_-5841113941042653637PageBody' width='640' valign='top' colspan='2' style='border-bottom:1px solid #e3e3e3;padding:10px 0 20px'>                                    <table cellpadding='0' cellspacing='0' border='0'>                                        <tbody>                                            <tr>                                                <td width='630' style='font-size:10pt;line-height:13pt;color:#000'>                                                    <table cellpadding='0' cellspacing='0' border='0' width='100%' dir='ltr' lang='en'>                                                        <tbody>                                                            <tr>                                                                <td>                                                                    <div style='font-family:'Segoe UI',Tahoma,sans-serif;font-size:14px;color:#333'>                                                                        <span>Thanks for verifying your <span style='color: #f8656d'>" + To + "</span> account!</span>                                                                    </div>                                                                    <br>                                                                    <div style='font-family:'Segoe UI',Tahoma,sans-serif;font-size:14px;color:#333;font-weight:bold'>                                    <span>                                                                            Please click on the link given below to complete your registration with SparesMe.<br />                                                                        </span>                                                                        <a href='" + URL + "' style='color: #f9676e'>Your Link (Verification)</a>                                                                    </div>                                                                    <br>                                                                    <br>                                                                    <div style='font-family:'Segoe UI',Tahoma,sans-serif;font-size:14px;color:#333'>                                                                        Sincerely,                                                                    </div>                                                                    <div style='font-family:'Segoe UI',Tahoma,sans-serif;font-size:14px;font-style:italic;color:#333'>                                                                        SparesME Team                                                                    </div>                                                                </td>                                                            </tr>                                                        </tbody>                                                    </table>                                                </td>                                            </tr>                                        </tbody>                                    </table>                                </td>                                <td width='1'>&nbsp;</td>                                <td width='1'></td>                                <td width='1'>&nbsp;</td>                                <td width='1' valign='top'></td>                                <td width='29'>&nbsp;</td>                                <td width='1' style='background:#e3e3e3'></td>                            </tr>                            <tr>                                <td width='1'></td>                                <td width='24'>&nbsp;</td>                                <td width='585' valign='top' colspan='6' style='padding:20px 0'>                                    <table cellpadding='0' cellspacing='0' border='0' width='585'>                                        <tbody>                                            <tr>                                                <td>                                                    <table cellpadding='0' cellspacing='0' border='0' dir='ltr' lang='en' style='margin-right:30px'>                                                        <tbody>                                                            <tr>                                                                <td>                                                                    <p style='font-family:'Segoe UI',Tahoma,sans-serif;margin:0px 0px 0px 5px;color:#666;font-size:10px'>                                                                        <span id=''>                                                                            SparesME                                                                            |                                                                            <a href='" + ConfigurationManager.AppSettings["WebSiteURL"] + "' style='color: #f9676e'>" + ConfigurationManager.AppSettings["WebSiteURL"] + "</a>                                                                            <br><br>                                                                        </span>                                                                        This message was sent from an unmonitored email address. Please do not reply to this message.                                                                    </p>                                                                </td>                                                            </tr>                                                        </tbody>                                                    </table>                                                </td>                                                <td style='padding:0;text-align:right'>                                                    <img id='SparesMeCompanyLogo' src='" + ConfigurationManager.AppSettings["WebSiteURL"] + "/" + ConfigurationManager.AppSettings["WebSiteLogo"] + "'>                                                </td>                                            </tr>                                        </tbody>                                    </table>                                </td>                                <td width='29' style='border-bottom:1px solid #e3e3e3'>&nbsp;</td>                                <td width='1' style='background:#e3e3e3;border-bottom:1px solid #e3e3e3'></td>                            </tr>                        </tbody>                    </table>                </td>                <td valign='top' width='0'></td>            </tr>        </tbody>    </table></body></html>");

            msg.IsBodyHtml = true; msg.Priority = MailPriority.High;
            SmtpClient emailClient = new SmtpClient();
            emailClient.EnableSsl = Convert.ToBoolean(ConfigurationManager.AppSettings["Email_EnableSsl"]);  //direct Zohomail than true

            emailClient.Send(msg);
            return "1";
        }
        catch (Exception ex)
        {
            return ex.Message + " Something went wrong, please try once again";
        }
    }

    public string EmailPoint_Customized(string Type, string FullName, string To, string Subject, string Content, string post)
    {
        try
        {
            string URL = ConfigurationManager.AppSettings["WebSiteURL"].ToString();
            MailMessage msg = new MailMessage();
            msg.From = new MailAddress(ConfigurationManager.AppSettings["Email_Sender"], "SparesMe " + Type);
            msg.To.Add(new MailAddress(To, "SparesMe " + Type));//TimeZoneInfo.ConvertTimeFromUtc(datet, tz).ToString("HHmmss")            
            msg.Subject = Subject + " : SparesMe";
            msg.IsBodyHtml = true;
            msg.Body = string.Format("<html><head>    <title></title></head><body>    <table width='auto' cellpadding='0' cellspacing='0' border='0' dir='ltr' lang='en' style='    border: 3px solid #f86971;'>        <tbody>            <tr>                <td valign='top' width='0'></td>                <td valign='top'>                    <table width='640' cellpadding='0' cellspacing='0' border='0' dir='ltr' lang='en'>                        <tbody>                            <tr style='background-color: #f86870;width:100%'>                                <td width='1'></td>                                <td width='24'>&nbsp;</td>                                <td width='310' valign='middle' style=';padding:12px 0'>                                    <h1 style='line-height:20pt;font-family:Segoe UI Light;font-size:18pt;color:#ffffff;font-weight:normal'>                                        <span style='color:#ffffff'>Verify your email address</span>                                    </h1>                                </td>                                <td width='24'>&nbsp;</td>                            </tr>                        </tbody>                    </table>                    <table width='640' cellpadding='0' cellspacing='0' border='0' dir='ltr' lang='en'>                        <tbody>                            <tr>                                <td width='1'></td>                                <td width='24'>&nbsp;</td>                                <td id='m_-5841113941042653637PageBody' width='640' valign='top' colspan='2' style='border-bottom:1px solid #e3e3e3;padding:10px 0 20px'>                                    <table cellpadding='0' cellspacing='0' border='0'>                                        <tbody>                                            <tr>                                                <td width='630' style='font-size:10pt;line-height:13pt;color:#000'>                                                    <table cellpadding='0' cellspacing='0' border='0' width='100%' dir='ltr' lang='en'>                                                        <tbody>                                                            <tr>                                                                <td>                                                                    <div style='font-family:'Segoe UI',Tahoma,sans-serif;font-size:14px;color:#333'>                                                                        <span>Thanks for verifying your <span style='color: #f8656d'>" + To + "</span> account!</span>                                                                    </div>                                                                    <br>                                                                    <div style='font-family:'Segoe UI',Tahoma,sans-serif;font-size:14px;color:#333;font-weight:bold'>                                    <span>                                                                            OTP given below to complete your registration with SparesMe.<br />                                                                        </span>                                                                        " + Content + "                                                                    </div>                                                                    <br>                                                                    <br>                                                                    <div style='font-family:'Segoe UI',Tahoma,sans-serif;font-size:14px;color:#333'>                                                                        Sincerely,                                                                    </div>                                                                    <div style='font-family:'Segoe UI',Tahoma,sans-serif;font-size:14px;font-style:italic;color:#333'>                                                                        SparesME Team                                                                    </div>                                                                </td>                                                            </tr>                                                        </tbody>                                                    </table>                                                </td>                                            </tr>                                        </tbody>                                    </table>                                </td>                                <td width='1'>&nbsp;</td>                                <td width='1'></td>                                <td width='1'>&nbsp;</td>                                <td width='1' valign='top'></td>                                <td width='29'>&nbsp;</td>                                <td width='1' style='background:#e3e3e3'></td>                            </tr>                            <tr>                                <td width='1'></td>                                <td width='24'>&nbsp;</td>                                <td width='585' valign='top' colspan='6' style='padding:20px 0'>                                    <table cellpadding='0' cellspacing='0' border='0' width='585'>                                        <tbody>                                            <tr>                                                <td>                                                    <table cellpadding='0' cellspacing='0' border='0' dir='ltr' lang='en' style='margin-right:30px'>                                                        <tbody>                                                            <tr>                                                                <td>                                                                    <p style='font-family:'Segoe UI',Tahoma,sans-serif;margin:0px 0px 0px 5px;color:#666;font-size:10px'>                                                                        <span id=''>                                                                            SparesME                                                                            |                                                                            <a href='" + ConfigurationManager.AppSettings["WebSiteURL"] + "' style='color: #f9676e'>" + ConfigurationManager.AppSettings["WebSiteURL"] + "</a>                                                                            <br><br>                                                                        </span>                                                                        This message was sent from an unmonitored email address. Please do not reply to this message.                                                                    </p>                                                                </td>                                                            </tr>                                                        </tbody>                                                    </table>                                                </td>                                                <td style='padding:0;text-align:right'>                                                    <img id='SparesMeCompanyLogo' src='" + ConfigurationManager.AppSettings["WebSiteURL"] + "/" + ConfigurationManager.AppSettings["WebSiteLogo"] + "'>                                                </td>                                            </tr>                                        </tbody>                                    </table>                                </td>                                <td width='29' style='border-bottom:1px solid #e3e3e3'>&nbsp;</td>                                <td width='1' style='background:#e3e3e3;border-bottom:1px solid #e3e3e3'></td>                            </tr>                        </tbody>                    </table>                </td>                <td valign='top' width='0'></td>            </tr>        </tbody>    </table></body></html>");

            msg.IsBodyHtml = true; msg.Priority = MailPriority.High;
            SmtpClient emailClient = new SmtpClient();
            emailClient.EnableSsl = Convert.ToBoolean(ConfigurationManager.AppSettings["Email_EnableSsl"]);  //direct Zohomail than true

            emailClient.Send(msg);
            return "1";
        }
        catch (Exception ex)
        {
            return ex.Message + " Something went wrong, please try once again";
        }
    }


}